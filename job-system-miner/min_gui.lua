local minigameWindowlocal minigameButton = {}local minigameImage = {}---------------Minigame GUI----------------function makeMinigameWindow()	local rx, ry = guiGetScreenSize()	minigameWindow = guiCreateWindow((rx/2) -167,(ry/2) -170,336,343,"Destroy all rocks to find iron...",false)	guiWindowSetSizable(minigameWindow,false)	guiSetAlpha(minigameWindow, 0.96)		--Buttons	minigameButton[1] = guiCreateButton ( 0.0655, 0.1166, 0.3214, 0.3324,"", true, minigameWindow)	minigameButton[2] = guiCreateButton ( 0.0655, 0.4956, 0.3214, 0.3324,"", true, minigameWindow)	minigameButton[3] = guiCreateButton ( 0.6071, 0.1137, 0.3214, 0.3324,"", true, minigameWindow)	minigameButton[4] = guiCreateButton ( 0.6101, 0.4956, 0.3214, 0.3324,"", true, minigameWindow)	finishMinigame = guiCreateButton(0.0685,0.8455,0.8631,0.1166,"Finish",true,minigameWindow)		--Images	minigameImage[1] = guiCreateStaticImage ( 0.0655,0.1166,0.3214, 0.3324, "images/rock.png", true, minigameWindow )	minigameImage[2] = guiCreateStaticImage ( 0.0655,0.4956,0.3214, 0.3324, "images/rock.png", true, minigameWindow )	minigameImage[3] = guiCreateStaticImage ( 0.6071,0.1137,0.3214, 0.3324, "images/rock.png", true, minigameWindow )	minigameImage[4] = guiCreateStaticImage ( 0.6101, 0.4956, 0.3214, 0.3324, "images/rock.png", true, minigameWindow )	--ProgressBar	minigameProgressBar = guiCreateProgressBar((rx/2) -350,(ry/2) -25,700,57,false)	guiSetVisible(minigameProgressBar , false)		--Events	addEventHandler("onClientGUIClick", finishMinigame, onMinigameFinish, false)	addEventHandler("onClientGUIClick", minigameImage[1], minigameDestroyRock1, false)	addEventHandler("onClientGUIClick", minigameImage[2], minigameDestroyRock2, false)	addEventHandler("onClientGUIClick", minigameImage[3], minigameDestroyRock3, false)	addEventHandler("onClientGUIClick", minigameImage[4], minigameDestroyRock4, false)endfunction onMinigameGUI()	if (minigameWindow) then		if (guiGetVisible(minigameWindow)) then			guiSetVisible(minigameWindow, false)			guiSetVisible(minigameProgressBar, false)			showCursor(false)		else			guiSetVisible(minigameWindow, true)			showCursor(true)			showMinigameElements()		end	else		makeMinigameWindow()		showCursor(true)	endendaddEvent("Miner.ShowMinigameGUI", true)addEventHandler("Miner.ShowMinigameGUI", root, onMinigameGUI)function showMinigameElements()	for i,v in ipairs (minigameImage) do		guiSetVisible (v, true)	end	for i,v in ipairs (minigameButton) do		guiSetVisible (v, true)	endendfunction onMinigameFinish()	triggerEvent("Miner.ShowMinigameGUI", root)	setTimer(triggerEvent, 1500, 1, "Miner.JobStarting", localPlayer)endfunction minigameProgressBarAddProgress(image, button)         	guiProgressBarSetProgress(minigameProgressBar, guiProgressBarGetProgress(minigameProgressBar) +1)                    	if (guiProgressBarGetProgress (minigameProgressBar) == 100) then		triggerServerEvent("Miner.GiveIron", localPlayer)		guiSetVisible (minigameProgressBar, false )		guiSetVisible (minigameWindow, true )		guiSetVisible (image, false )		guiSetVisible (button, false )			guiProgressBarSetProgress(minigameProgressBar, 0) 	endendprogresstimer1 = nilfunction minigameDestroyRock1 ()	guiSetVisible (minigameProgressBar, true )	guiSetVisible (minigameWindow, false )	progresstimer1 = setTimer (minigameProgressBarAddProgress, 100, 100, source, minigameButton[1])endprogresstimer2 = nilfunction minigameDestroyRock2 ()	guiSetVisible (minigameProgressBar, true )	guiSetVisible (minigameWindow, false )	progresstimer2 = setTimer (minigameProgressBarAddProgress, 100, 100, source, minigameButton[2])endprogresstimer3 = nilfunction minigameDestroyRock3 ()	guiSetVisible (minigameProgressBar, true )	guiSetVisible (minigameWindow, false )	progresstimer3 = setTimer (minigameProgressBarAddProgress, 100, 100, source, minigameButton[3])endprogresstimer4 = nilfunction minigameDestroyRock4 ()	guiSetVisible (minigameProgressBar, true )	guiSetVisible (minigameWindow, false )	progresstimer4 = setTimer (minigameProgressBarAddProgress, 100, 100, source, minigameButton[4])endfunction hideAllOnQuit()	if (minigameWindow) then		if (guiGetVisible(minigameWindow)) then			guiSetVisible(minigameWindow, false)			guiSetVisible(minigameProgressBar, false)			showCursor(false)		end	end	if (minigameProgressBar) then		guiSetVisible(minigameProgressBar, false)		showCursor(false)		if (isTimer(progresstimer1)) then			killTimer(progresstimer1)		elseif (isTimer(progresstimer2)) then			killTimer(progresstimer2)		elseif (isTimer(progresstimer3)) then			killTimer(progresstimer3)		elseif (isTimer(progresstimer4)) then			killTimer(progresstimer4)		end	end	if (factoryWindow) then		if (guiGetVisible(factoryWindow)) then			guiSetVisible(factoryWindow, false)			showCursor(false)		end	endendaddEvent("Miner.hidewindowsonquit", true)addEventHandler("Miner.hidewindowsonquit", localPlayer, hideAllOnQuit)function hideAllOnDead(killer, weapon, bodypart)	if (minigameWindow) then		if (guiGetVisible(minigameWindow)) then			guiSetVisible(minigameWindow, false)			guiSetVisible(minigameProgressBar, false)			showCursor(false)		end		guiProgressBarSetProgress(minigameProgressBar, 0) 	end	if (minigameProgressBar) then		guiSetVisible(minigameProgressBar, false)		showCursor(false)		if (isTimer(progresstimer1)) then			killTimer(progresstimer1)		elseif (isTimer(progresstimer2)) then			killTimer(progresstimer2)		elseif (isTimer(progresstimer3)) then			killTimer(progresstimer3)		elseif (isTimer(progresstimer4)) then			killTimer(progresstimer4)		end	end	if (getElementData(localPlayer, "job") == 7) then		setTimer(triggerEvent, 1500, 1, "Miner.JobStarting", localPlayer)	endendaddEventHandler("onClientPlayerWasted", localPlayer, hideAllOnDead)